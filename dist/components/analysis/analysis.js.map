{"version":3,"sources":["../../../src/components/analysis/analysis.js"],"names":["_","angular","d3","vizuly","Dygraph","Downsampler","Colormap","Testdata","AnalysisCtrl","$scope","$injector","$rootScope","$location","$modal","$anchorScroll","$timeout","$window","$q","backendSrv","alertSrv","self","scope","rootscope","pageReady","ignoreChanges","config","deviceStatus","search","console","log","location","device","onbeforeunload","changesPending","$on","event","next","preventDefault","baseLen","absUrl","length","url","nextUrl","substring","modalScope","$new","ignore","save","savePending","appEvent","src","modalClass","radialLayouts","text","value","filterModes","filterTaps","windowModes","radialThemes","radial_viz","component","corona","window","document","getElementById","$","remove","radial_data","radial_viz_element","radial_viz_title_element","radial_viz_heading_element","radial_viz_theme","screenWidth","innerWidth","screenHeight","innerHeight","selectAll","style","loadData","highlight_start","highlight_end","data","fft","labels","ylabel","xlabel","axes","x","axisLabelFormatter","d","gran","valueFormatter","ms","y","legend","plotter","barChartPlotter","colorValue","fillAlpha","showRoller","showRangeSelector","rangeSelectorPlotFillColor","rangeSelectorPlotFillGradientColor","animatedZooms","underlayCallback","canvas","area","g","bottom_left","toDomCoords","top_right","left","right","fillStyle","fillRect","h","rawplot","loadRaw","loadFFT","e","ctx","drawingContext","points","y_bottom","dygraph","toDomYCoord","color","dygraph_downsample","bar_width","canvasx","i","p","colorIndex","plotArea","canvasy","interpolateLinearly","jet","strokeStyle","Math","round","ranges","push","label","id","splice","options","mode","post","then","resp","meta","code","set","message","reject","ms_per_point","updateOptions","fftData","hzperbin","uid","get","body","changes","allSeries","hz","series","key","Number","sin","String","initialize","margin","top","bottom","outerRadius","amplitude","position","interpolate","on","xAxis","tickFormat","yAxis","ticks","fontSize","defs","selection","plot","append","attr","svg","arcPath","radiusScale","y0","thetaScale","skin","labelColor","theme","radial_linearea","LINEAREA_FIRE","updateRadialSize","radialTheme","apply","layout","radialLayout","update","val","transition","r","min","width","height","innerRadius","templateUrl"],"mappings":";;;;;;;;;;;;;;;AAAOA,O;;AACAC,a;;AACKC,Q;;AACLC,Y;;AAEAC,a;;AACKC,iB;;AACAC,c;;AACAC,c;;;;;;;;;;;;;;;;;;;;;8BAGNC,Y;AACJ;AACA,8BAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2CC,SAA3C,EAAsDC,MAAtD,EAA8DC,aAA9D,EAA6EC,QAA7E,EAAuFC,OAAvF,EAAgGC,EAAhG,EAAoGC,UAApG,EAAgHC,QAAhH,EAA0H;AAAA;;AACxH,cAAIC,OAAO,IAAX;AACA,eAAKF,UAAL,GAAkBA,UAAlB;AACA,eAAKN,SAAL,GAAiBA,SAAjB;AACA,eAAKG,QAAL,GAAgBA,QAAhB;AACA,eAAKE,EAAL,GAAUA,EAAV;AACA,eAAKE,QAAL,GAAgBA,QAAhB;AACA,eAAKH,OAAL,GAAeA,OAAf;AACA,eAAKL,UAAL,GAAkBA,UAAlB;AACAK,kBAAQK,KAAR,GAAgBZ,MAAhB;AACAO,kBAAQM,SAAR,GAAoBX,UAApB;AACA,eAAKY,SAAL,GAAiB,KAAjB;AACA,eAAKC,aAAL,GAAqB,KAArB;AACA,eAAKC,MAAL,GAAc,EAAd;AACA,eAAKC,YAAL,GAAoB,CAApB,CAdwH,CAcjG;;AAEvB,cAAI,YAAYd,UAAUe,MAAV,EAAhB,EAAoC;AAClCC,oBAAQC,GAAR,CAAYC,SAASH,MAAT,GAAkBI,MAA9B;AACA;AACD;;AAEDX,eAAKG,SAAL,GAAiB,IAAjB;;AAEAP,kBAAQgB,cAAR,GAAyB,YAAW;AAClC,gBAAIZ,KAAKI,aAAT,EAAwB;AACtB;AACD;AACD,gBAAIJ,KAAKa,cAAL,EAAJ,EAA2B;AACzB,qBAAO,6CAAP;AACD;AACF,WAPD;AAQAxB,iBAAOyB,GAAP,CAAW,sBAAX,EAAmC,UAASC,KAAT,EAAgBC,IAAhB,EAAsB;AACvD,gBAAK,CAAChB,KAAKI,aAAP,IAA0BJ,KAAKa,cAAL,EAA9B,EAAsD;AACpDE,oBAAME,cAAN;AACA,kBAAIC,UAAU1B,UAAU2B,MAAV,GAAmBC,MAAnB,GAA4B5B,UAAU6B,GAAV,GAAgBD,MAA1D;AACA,kBAAIE,UAAUN,KAAKO,SAAL,CAAeL,OAAf,CAAd;AACA,kBAAIM,aAAanC,OAAOoC,IAAP,EAAjB;AACAD,yBAAWE,MAAX,GAAoB,YAAW;AAC7B1B,qBAAKI,aAAL,GAAqB,IAArB;AACAZ,0BAAU6B,GAAV,CAAcC,OAAd;AACA;AACD,eAJD;AAKAE,yBAAWG,IAAX,GAAkB,YAAW;AAC3B3B,qBAAK4B,WAAL,CAAiBN,OAAjB;AACD,eAFD;AAGA/B,yBAAWsC,QAAX,CAAoB,YAApB,EAAkC;AAChCC,qBAAK,0CAD2B;AAEhCC,4BAAY,eAFoB;AAGhC9B,uBAAOuB;AAHyB,eAAlC;AAKD;AACF,WApBD;;AAsBA,eAAKQ,aAAL,GAAqB,CAAC;AAClBC,kBAAM,SADY;AAElBC,mBAAO;AAFW,WAAD,EAInB;AACED,kBAAM,SADR;AAEEC,mBAAO;AAFT,WAJmB,CAArB;;AAWA,eAAKC,WAAL,GAAmB,CAAC;AAChBF,kBAAM,eADU;AAEhBC,mBAAO;AAFS,WAAD,EAIjB;AACED,kBAAM,eADR;AAEEC,mBAAO;AAFT,WAJiB,EAQjB;AACED,kBAAM,cADR;AAEEC,mBAAO;AAFT,WARiB,CAAnB;;AAcA,eAAKE,UAAL,GAAkB,CAAC,MAAD,EAAS,KAAT,EAAgB,KAAhB,EAAuB,KAAvB,EAA8B,IAA9B,EAAoC,IAApC,EAA0C,IAA1C,EAAgD,GAAhD,EAAqD,GAArD,CAAlB;AACA,eAAKC,WAAL,GAAmB,CAAC,QAAD,EAAW,SAAX,EAAsB,SAAtB,EAAiC,QAAjC,EAA2C,UAA3C,EAAuD,YAAvD,EAAqE,UAArE,EAAiF,iBAAjF,EAAoG,UAApG,EAAgH,SAAhH,EAA2H,MAA3H,CAAnB;;AAIA;AACA,eAAKC,YAAL,GAAoB,CAAC;AACjBL,kBAAM,QADW;AAEjBC,mBAAO;AAFU,WAAD,EAIlB;AACED,kBAAM,MADR;AAEEC,mBAAO;AAFT,WAJkB,EAQlB;AACED,kBAAM,MADR;AAEEC,mBAAO;AAFT,WARkB,EAYlB;AACED,kBAAM,OADR;AAEEC,mBAAO;AAFT,WAZkB,EAgBlB;AACED,kBAAM,OADR;AAEEC,mBAAO;AAFT,WAhBkB,CAApB;;AAsBA;AACA,eAAKK,UAAL,GAAkBxD,OAAOyD,SAAP,CAAiBC,MAAjB,CAAwBC,OAAOC,QAAP,CAAgBC,cAAhB,CAA+B,oBAA/B,CAAxB,CAAlB;;AAEAC,YAAE,gBAAF,EAAoBC,MAApB;;AAEA,eAAKC,WAAL,GAAmB,EAAnB,CA/GwH,CA+GjG;AACvB,eAAKC,kBAAL,GAA0B,EAA1B,CAhHwH,CAgH1F;AAC9B,eAAKC,wBAAL,GAAgC,EAAhC,CAjHwH,CAiHpF;AACpC,eAAKC,0BAAL,GAAkC,EAAlC,CAlHwH,CAkHlF;AACtC,eAAKC,gBAAL,GAAwB,EAAxB,CAnHwH,CAmH5F;;AAE5B,eAAKC,WAAL,GAAmBV,OAAOW,UAAP,GAAoB,IAAvC;AACA,eAAKC,YAAL,GAAoBZ,OAAOa,WAA3B;AACA;;AAEA,eAAKP,kBAAL,GAA0BlE,GAAG0E,SAAH,CAAa,qBAAb,EACvBC,KADuB,CACjB,OADiB,EACR,KAAKL,WAAL,GAAmB,IADX,EAEvBK,KAFuB,CAEjB,QAFiB,EAEP,KAAKH,YAAL,GAAoB,IAFb,CAA1B;AAGA,eAAKI,QAAL;;AAKA;;;AAIA;AACA,cAAIC,kBAAkB,GAAtB;AACA,cAAIC,gBAAgB,GAApB;;AAIA;AACA,cAAIC,OAAO,EAAX;;AAEA,eAAKC,GAAL,GAAW,IAAI9E,OAAJ,CAAY0D,OAAOC,QAAP,CAAgBC,cAAhB,CAA+B,KAA/B,CAAZ,EAAmDiB,IAAnD,EAAyD;AAClEE,oBAAQ,CAAC,WAAD,EAAc,IAAd,CAD0D;AAElEC,oBAAQ,eAF0D;AAGlEC,oBAAQ,gBAH0D;AAIlEC,kBAAM;AACJC,iBAAG;AACDC,oCAAoB,4BAASC,CAAT,EAAYC,IAAZ,EAAkB;AACpC,yBAAOD,IAAI,IAAX;AACD,iBAHA;AAIDE,gCAAgB,wBAASC,EAAT,EAAa;AAC3B,yBAAOA,KAAK,IAAZ;AACD;AANA,eADC;AASJC,iBAAG;AACDL,oCAAoB,4BAASC,CAAT,EAAYC,IAAZ,EAAkB;AACpC,yBAAOD,IAAI,GAAX;AACD,iBAHA;AAIDE,gCAAgB,wBAASC,EAAT,EAAa;AAC3B,yBAAOA,KAAK,GAAZ;AACD;AANA;AATC,aAJ4D;AAsBlEE,oBAAQ,QAtB0D;AAuBlE;AACAC,qBAAS,KAAKC,eAxBoD;AAyBlEC,wBAAY,GAzBsD;AA0BlEC,uBAAW,GA1BuD;AA2BlEC,wBAAY,KA3BsD;AA4BlEC,+BAAmB,KA5B+C;AA6BlEC,wCAA4B,iBA7BsC;AA8BlEC,gDAAoC,wBA9B8B;AA+BlEC,2BAAe,IA/BmD;AAgClEC,8BAAkB,0BAASC,MAAT,EAAiBC,IAAjB,EAAuBC,CAAvB,EAA0B;AAC1C,kBAAIC,cAAcD,EAAEE,WAAF,CAAc9B,eAAd,EAA+B,CAAC,EAAhC,CAAlB;AACA,kBAAI+B,YAAYH,EAAEE,WAAF,CAAc7B,aAAd,EAA6B,CAAC,EAA9B,CAAhB;AACA,kBAAI+B,OAAOH,YAAY,CAAZ,CAAX;AACA,kBAAII,QAAQF,UAAU,CAAV,CAAZ;AACAL,qBAAOQ,SAAP,GAAmB,0BAAnB;AACAR,qBAAOS,QAAP,CAAgBH,IAAhB,EAAsBL,KAAKb,CAA3B,EAA8BmB,QAAQD,IAAtC,EAA4CL,KAAKS,CAAjD;AACD;AAvCiE,WAAzD,CAAX;;AA+CA;;;AAKA,eAAKC,OAAL,GAAe,IAAIhH,OAAJ,CAAY0D,OAAOC,QAAP,CAAgBC,cAAhB,CAA+B,eAA/B,CAAZ,EAA6DiB,IAA7D,EAAmE;AAChFE,oBAAQ,CAAC,MAAD,EAAS,OAAT,CADwE;AAEhFC,oBAAQ,eAFwE;AAGhFC,oBAAQ,WAHwE;AAIhFC,kBAAM;AACJC,iBAAG;AACDC,oCAAoB,4BAASC,CAAT,EAAYC,IAAZ,EAAkB;AACpC,yBAAOD,IAAI,IAAX;AACD,iBAHA;AAIDE,gCAAgB,wBAASC,EAAT,EAAa;AAC3B,yBAAOA,KAAK,IAAZ;AACD;AANA,eADC;AASJC,iBAAG;AACDL,oCAAoB,4BAASC,CAAT,EAAYC,IAAZ,EAAkB;AACpC,yBAAOD,IAAI,GAAX;AACD,iBAHA;AAIDE,gCAAgB,wBAASC,EAAT,EAAa;AAC3B,yBAAOA,KAAK,GAAZ;AACD;AANA;AATC,aAJ0E;AAsBhFK,wBAAY,GAtBoE;AAuBhFC,uBAAW,GAvBqE;AAwBhFC,wBAAY,KAxBoE;AAyBhFL,oBAAQ,QAzBwE;AA0BhFM,+BAAmB,KA1B6D;AA2BhFC,wCAA4B,iBA3BoD;AA4BhFC,gDAAoC,wBA5B4C;AA6BhFC,2BAAe;AA7BiE,WAAnE,CAAf;;AAiCA,eAAKc,OAAL,CAAa,CAAb,EAAgB,MAAhB;AACA,eAAKC,OAAL,CAAa,CAAb,EAAgB,MAAhB;AACD;;;;0CASeC,C,EAAG;AACjB,gBAAIC,MAAMD,EAAEE,cAAZ;AACA,gBAAIC,SAASH,EAAEG,MAAf;AACA,gBAAIC,WAAWJ,EAAEK,OAAF,CAAUC,WAAV,CAAsB,CAAtB,CAAf,CAHiB,CAGwB;AACzC;;AAEAL,gBAAIP,SAAJ,GAAgBM,EAAEO,KAAlB,CANiB,CAMQ;;;AAMzBJ,qBAASrH,YAAY0H,kBAAZ,CAA+BL,MAA/B,EAAuC,IAAvC,EAA6C,KAA7C,CAAT;;AAEA,gBAAIM,YAAY,IAAI,CAAJ,IAASN,OAAO,CAAP,EAAUO,OAAV,GAAoBP,OAAO,CAAP,EAAUO,OAAvC,CAAhB;;AAGA;AACA,iBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIR,OAAOlF,MAA3B,EAAmC0F,GAAnC,EAAwC;AACtC,kBAAIC,IAAIT,OAAOQ,CAAP,CAAR;AACA;;AAEA,kBAAIE,aAAa,CAACb,EAAEc,QAAF,CAAWlB,CAAX,GAAegB,EAAEG,OAAlB,IAA6Bf,EAAEc,QAAF,CAAWlB,CAAzD;AACA,kBAAIW,QAAQxH,SAASiI,mBAAT,CAA6BH,UAA7B,EAAyC9H,SAASkI,GAAlD,CAAZ;AACAhB,kBAAIiB,WAAJ,GAAkB,SAChBC,KAAKC,KAAL,CAAW,MAAMb,MAAM,CAAN,CAAjB,CADgB,GACa,GADb,GAEhBY,KAAKC,KAAL,CAAW,MAAMb,MAAM,CAAN,CAAjB,CAFgB,GAEa,GAFb,GAGhBY,KAAKC,KAAL,CAAW,MAAMb,MAAM,CAAN,CAAjB,CAHgB,GAIhB,GAJF;AAKAN,kBAAIP,SAAJ,GAAgBO,IAAIiB,WAApB;;AAEAjB,kBAAIN,QAAJ,CAAaiB,EAAEF,OAAF,GAAYD,YAAY,CAArC,EAAwCG,EAAEG,OAA1C,EAAmDN,SAAnD,EAA8DL,WAAWQ,EAAEG,OAA3E;AACA;AACD;AACF;;;qCAKU;AACT,gBAAI,CAAC,KAAK7G,MAAL,CAAYmH,MAAjB,EAAyB;AACvB,mBAAKnH,MAAL,CAAYmH,MAAZ,GAAqB,EAArB;AACD;;AAED,iBAAKnH,MAAL,CAAYmH,MAAZ,CAAmBC,IAAnB,CAAwB;AACtBC,qBAAO;AADe,aAAxB,IAEK,CAFL;AAGD;;;sCAEWC,E,EAAI;AACd,iBAAKtH,MAAL,CAAYmH,MAAZ,CAAmBI,MAAnB,CAA0BD,EAA1B,EAA8B,CAA9B;AACD;;;kCAGOA,E,EAAIrB,M,EAAQ;AAClB,gBAAItG,OAAO,IAAX;;AAEA,gBAAI6H,UAAU;AACZC,oBAAM;AADM,aAAd;;AAIA,mBAAO,KAAKhI,UAAL,CAAgBiI,IAAhB,CAAqB,yDAAyDJ,EAA9E,EAAkFE,OAAlF,EACJG,IADI,CACC,UAACC,IAAD,EAAU;AACdjI,mBAAKJ,OAAL,CAAaY,OAAb,CAAqBC,GAArB,CAAyBwH,IAAzB;AACA,kBAAIA,KAAKC,IAAL,CAAUC,IAAV,KAAmB,GAAvB,EAA4B;AAC1BnI,qBAAKD,QAAL,CAAcqI,GAAd,CAAkB,qBAAlB,EAAyCH,KAAKC,IAAL,CAAUG,OAAnD,EAA4D,OAA5D,EAAqE,KAArE;AACA,uBAAOrI,KAAKH,EAAL,CAAQyI,MAAR,CAAeL,KAAKC,IAAL,CAAUG,OAAzB,CAAP;AACD;;AAED,kBAAIxE,OAAO,EAAX;;AAEA,mBAAK,IAAIiD,IAAI,CAAb,EAAgBA,IAAImB,KAAKpE,IAAL,CAAUzC,MAA9B,EAAsC0F,GAAtC,EAA2C;AACzCjD,qBAAK4D,IAAL,CAAU,CAACX,IAAImB,KAAKM,YAAV,EAAwBN,KAAKpE,IAAL,CAAUiD,CAAV,CAAxB,CAAV;AACD;;AAED9G,mBAAKgG,OAAL,CAAawC,aAAb,CAA2B;AACzB,wBAAQ3E;AADiB,eAA3B;AAID,aAlBI,CAAP;AAmBD;;;kCAIO8D,E,EAAIrB,M,EAAQ;AAClB,gBAAItG,OAAO,IAAX;;AAEA,gBAAI6H,UAAU;AACZC,oBAAM;AADM,aAAd;;AAIA,mBAAO,KAAKhI,UAAL,CAAgBiI,IAAhB,CAAqB,yDAAyDJ,EAA9E,EAAkFE,OAAlF,EACJG,IADI,CACC,UAACC,IAAD,EAAU;AACdjI,mBAAKJ,OAAL,CAAaY,OAAb,CAAqBC,GAArB,CAAyBwH,IAAzB;AACA,kBAAIA,KAAKC,IAAL,CAAUC,IAAV,KAAmB,GAAvB,EAA4B;AAC1BnI,qBAAKD,QAAL,CAAcqI,GAAd,CAAkB,qBAAlB,EAAyCH,KAAKC,IAAL,CAAUG,OAAnD,EAA4D,OAA5D,EAAqE,KAArE;AACA,uBAAOrI,KAAKH,EAAL,CAAQyI,MAAR,CAAeL,KAAKC,IAAL,CAAUG,OAAzB,CAAP;AACD;;AAED,kBAAII,UAAU,EAAd;;AAEA,mBAAK,IAAI3B,IAAI,CAAb,EAAgBA,IAAImB,KAAKpE,IAAL,CAAUzC,MAA9B,EAAsC0F,GAAtC,EAA2C;AACzC2B,wBAAQhB,IAAR,CAAa,CAACX,IAAImB,KAAKS,QAAV,EAAoBT,KAAKpE,IAAL,CAAUiD,CAAV,CAApB,CAAb;AACD;;AAED9G,mBAAK8D,GAAL,CAAS0E,aAAT,CAAuB;AACrB,wBAAQC;AADa,eAAvB;AAID,aAlBI,CAAP;AAmBD;;;qCAIUE,G,EAAK;AAAA;;AACd,gBAAI3I,OAAO,IAAX;AACA,mBAAO,KAAKF,UAAL,CAAgB8I,GAAhB,CAAoB,4DAA4DD,GAAhF,EAAqFX,IAArF,CAA0F,UAACC,IAAD,EAAU;AACzGjI,mBAAKJ,OAAL,CAAaY,OAAb,CAAqBC,GAArB,CAAyBwH,IAAzB;AACA,kBAAIA,KAAKC,IAAL,CAAUC,IAAV,KAAmB,GAAvB,EAA4B;AAC1BnI,qBAAKD,QAAL,CAAcqI,GAAd,CAAkB,0BAAlB,EAA8CH,KAAKC,IAAL,CAAUG,OAAxD,EAAiE,OAAjE,EAA0E,KAA1E;AACA,uBAAOrI,KAAKH,EAAL,CAAQyI,MAAR,CAAeL,KAAKC,IAAL,CAAUG,OAAzB,CAAP;AACD;AACDrI,mBAAKK,MAAL,GAAc4H,KAAKY,IAAnB;AACA,oBAAKvI,YAAL,GAAoB,CAApB;AACD,aARM,CAAP;AASD;;;2CAIgB;AACf,gBAAIwI,UAAU,KAAd;AACA,mBAAOA,OAAP;AACD;;;qCAIU;AACT;AACA,gBAAIC,YAAY,EAAhB;AACA,iBAAK,IAAIC,KAAK,CAAd,EAAiBA,KAAK,CAAtB,EAAyBA,IAAzB,EAA+B;AAC7B,kBAAIC,SAAS,EAAb;AACA,kBAAIC,MAAMF,KAAK,IAAf;AACA,mBAAK,IAAIxE,KAAK,CAAd,EAAiBA,KAAK,GAAtB,EAA2BA,IAA3B,EAAiC;AAC/ByE,uBAAOxB,IAAP,CAAY;AACV,yBAAOyB,GADG;AAEV,+BAAaA,GAFH;AAGV,+BAAaC,OAAQ7B,KAAK8B,GAAL,CAAU5E,KAAK,CAAN,GAAWwE,KAAK,CAAzB,IAA8B,CAAtC,IAA4CA,EAH/C;AAIV,8BAAYK,OAAO7E,EAAP;AAJF,iBAAZ;AAMD;AACDuE,wBAAUtB,IAAV,CAAewB,MAAf;AACD;AACD,iBAAKlG,WAAL,GAAmBgG,SAAnB;AACAvI,oBAAQC,GAAR,CAAY,KAAKsC,WAAjB;AACA;AACA,iBAAKuG,UAAL;AACD;;;uCAQY;AACX,gBAAItJ,OAAO,IAAX;AACA;AACA,iBAAKuC,UAAL,CAAgBsB,IAAhB,CAAqB,KAAKd,WAA1B,EAAuCwG,MAAvC,CAA8C;AAC1CC,mBAAK,KADqC;AAE1C7D,oBAAM,IAFoC;AAG1CC,qBAAO,IAHmC;AAI1C6D,sBAAQ;AAJkC,aAA9C,EAKKC,WALL,CAKiB,GALjB,EAKsBjF,CALtB,CAKwB,UAASJ,CAAT,EAAYyC,CAAZ,EAAe;AACnC,qBAAOzC,EAAEsF,SAAT,CADmC,CACf;AACrB,aAPH,EAOKxF,CAPL,CAOO,UAASE,CAAT,EAAYyC,CAAZ,EAAe;AAClB,qBAAOzC,EAAEuF,QAAT,CADkB,CACC;AACpB,aATH,EASKC,WATL,CASiB,iBATjB,EASoC;AATpC,aAUGC,EAVH,CAUM,UAVN,EAUkB,YAAW;AAAE;AAC3B;AACA9J,mBAAKuC,UAAL,CAAgBwH,KAAhB,GAAwBC,UAAxB,CAAmC,UAAS3F,CAAT,EAAY;AAC7C,uBAAOA,IAAI,GAAX;AACD,eAFD;AAGArE,mBAAKuC,UAAL,CAAgB0H,KAAhB,GAAwBD,UAAxB,CAAmC,UAAS3F,CAAT,EAAY;AAC7C,uBAAOiD,KAAKC,KAAL,CAAWlD,IAAI,GAAf,IAAsB,GAAtB,GAA4B,IAAnC;AACD,eAFD;AAGArE,mBAAKuC,UAAL,CAAgBwH,KAAhB,GAAwBG,KAAxB,CAA8B,CAA9B;AACAlK,mBAAKuC,UAAL,CAAgB0H,KAAhB,GAAwBC,KAAxB,CAA8B,CAA9B;AACD,aApBH,EAoBK;AApBL,aAqBGJ,EArBH,CAqBM,WArBN,EAqBmB,UAASzF,CAAT,EAAYyC,CAAZ,EAAe;AAAE;AAChC;AACA,kBAAIqD,WAAW7C,KAAKC,KAAL,CAAWvH,KAAKuC,UAAL,CAAgBmH,WAAhB,KAAgC,EAA3C,CAAf;AACA;AACA,kBAAIU,OAAOpK,KAAKuC,UAAL,CAAgB8H,SAAhB,GAA4B7G,SAA5B,CAAsC,MAAtC,CAAX;;AAGA;AACA,kBAAI8G,OAAOtK,KAAKuC,UAAL,CAAgB8H,SAAhB,GAA4B7G,SAA5B,CAAsC,UAAtC,CAAX;;AAIA;AACA4G,mBAAK5G,SAAL,CAAe,cAAf,EAA+BV,MAA/B;AACAwH,mBAAK9G,SAAL,CAAe,SAAf,EAA0BV,MAA1B;;AAGA;AACAsH,mBAAKG,MAAL,CAAY,MAAZ,EAAoBC,IAApB,CAAyB,OAAzB,EAAkC,aAAlC,EAAiDA,IAAjD,CAAsD,IAAtD,EAA4D,UAASnG,CAAT,EAAYyC,CAAZ,EAAe;AACzE,uBAAO9G,KAAKuC,UAAL,CAAgBoF,EAAhB,KAAuB,iBAA9B;AACD,eAFD,EAEG6C,IAFH,CAEQ,GAFR,EAEa,YAAW;AACtB,uBAAOzL,OAAO0L,GAAP,CAAWxI,IAAX,CAAgByI,OAAhB,CAAwB1K,KAAKuC,UAAL,CAAgBoI,WAAhB,GAA8BtG,EAAEI,CAAF,GAAMJ,EAAEuG,EAAtC,IAA4C,IAApE,EAA0E5K,KAAKuC,UAAL,CAAgBsI,UAAhB,GAA6B7K,KAAKuC,UAAL,CAAgB4B,CAAhB,GAAoBE,CAApB,CAA7B,CAA1E,CAAP;AACD,eAJD;;AAOA;AACAiG,mBAAKC,MAAL,CAAY,MAAZ,EAAoBC,IAApB,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C/G,KAA5C,CAAkD,WAAlD,EAAgE0G,WAAW,IAAZ,GAAoB,IAAnF,EAAyF1G,KAAzF,CAA+F,gBAA/F,EAAiH,WAAjH,EAA8HA,KAA9H,CAAoI,aAApI,EAAmJ,WAAnJ,EAAgKA,KAAhK,CAAsK,cAAtK,EAAsL,IAAtL,EAA4LA,KAA5L,CAAkM,MAAlM,EAA0M,YAAW;AACnN,uBAAOzD,KAAKmD,gBAAL,CAAsB2H,IAAtB,GAA6BC,UAApC;AACD,eAFD,EAEGR,MAFH,CAEU,UAFV,EAEsBC,IAFtB,CAE2B,aAF3B,EAE0C,KAF1C,EAEiD/G,KAFjD,CAEuD,UAFvD,EAEmE,SAFnE,EAE8E+G,IAF9E,CAEmF,YAFnF,EAEiG,UAASnG,CAAT,EAAYyC,CAAZ,EAAe;AAC9G,uBAAO,MAAM9G,KAAKuC,UAAL,CAAgBoF,EAAhB,EAAN,GAA6B,iBAApC;AACD,eAJD,EAIG1F,IAJH,CAIQ,YAAW;AACjB,uBAAOjC,KAAKuC,UAAL,CAAgBwH,KAAhB,GAAwBC,UAAxB,GAAqChK,KAAKuC,UAAL,CAAgB4B,CAAhB,GAAoBE,CAApB,CAArC,CAAP;AACD,eAND;;AASA;AACAiG,mBAAKC,MAAL,CAAY,MAAZ,EAAoBC,IAApB,CAAyB,OAAzB,EAAkC,QAAlC,EAA4CA,IAA5C,CAAiD,GAAjD,EAAsD,CAACL,QAAD,GAAY,GAAlE,EAAuE1G,KAAvE,CAA6E,WAA7E,EAA0F0G,WAAW,IAArG,EAA2G1G,KAA3G,CAAiH,MAAjH,EAAyH,YAAW;AAClI,uBAAOzD,KAAKmD,gBAAL,CAAsB2H,IAAtB,GAA6BC,UAApC;AACD,eAFD,EAEG9I,IAFH,CAEQ,YAAW;AACjB,uBAAOjC,KAAKuC,UAAL,CAAgB0H,KAAhB,GAAwBD,UAAxB,GAAqChK,KAAKuC,UAAL,CAAgBkC,CAAhB,GAAoBJ,CAApB,CAArC,CAAP;AACD,eAJD;AAKA;AACAiG,mBAAKC,MAAL,CAAY,MAAZ,EAAoBC,IAApB,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C/G,KAA5C,CAAkD,WAAlD,EAA+D0G,WAAW,IAA1E,EAAgF1G,KAAhF,CAAsF,cAAtF,EAAsG,IAAtG,EAA4GA,KAA5G,CAAkH,MAAlH,EAA0H,YAAW;AACnI,uBAAOzD,KAAKmD,gBAAL,CAAsB2H,IAAtB,GAA6BC,UAApC;AACD,eAFD,EAEG9I,IAFH,CAEQ,YAAW;AACjB,uBAAOoC,EAAE6E,GAAT;AACD,eAJD;AAOD,aAtEH,EAsEK;;;AAtEL,aA0EGY,EA1EH,CA0EM,UA1EN,EA0EkB,UAASzF,CAAT,EAAYyC,CAAZ,EAAe;AAAE;AAC/B;AACA9G,mBAAKuC,UAAL,CAAgB8H,SAAhB,GAA4B7G,SAA5B,CAAsC,cAAtC,EAAsDV,MAAtD;AACA9C,mBAAKuC,UAAL,CAAgB8H,SAAhB,GAA4B7G,SAA5B,CAAsC,SAAtC,EAAiDV,MAAjD;AACD,aA9EH,EA8EK;AA9EL,aA+EGgH,EA/EH,CA+EM,SA/EN,EA+EiB,YAAW;AACxB;;AAEA;;;;;;;;;;;;;;;AAkBD,aApGH,EAHW,CAuGL;;;AAGN,iBAAK3G,gBAAL,GAAwBpE,OAAOiM,KAAP,CAAaC,eAAb,CAA6B,KAAK1I,UAAlC,EAA8CuI,IAA9C,CAAmD/L,OAAO+L,IAAP,CAAYI,aAA/D,CAAxB;;AAEA;;;;;;;;;AASA,iBAAKC,gBAAL;AACD;;;8CAQmB;AAClB;AACA,gBAAI,CAAC,KAAK9K,MAAL,CAAY+K,WAAjB,EAA8B;AAC5B;AACD;;AAED,iBAAKjI,gBAAL,CAAsB2H,IAAtB,CAA2B,KAAKzK,MAAL,CAAY+K,WAAvC;AACA;AACA;AACA,iBAAKjI,gBAAL,CAAsBkI,KAAtB;AACD;;;+CAIoB;AACnB;AACA,iBAAK9I,UAAL,CAAgB+I,MAAhB,CAAuB,KAAKjL,MAAL,CAAYkL,YAAnC,EAAiDC,MAAjD;AACD;;;sCAIWC,G,EAAK;AACfjL,oBAAQC,GAAR,CAAYgL,GAAZ;AACA,iBAAKlJ,UAAL,CAAgBsH,WAAhB,CAA4B4B,GAA5B,EAAiCD,MAAjC;AACD;;;6CAIkB;AACjB,iBAAKxI,kBAAL,CAAwB0I,UAAxB,GAAqCjI,KAArC,CAA2C,OAA3C,EAAoD,KAAKL,WAAL,GAAmB,IAAvE,EAA6EK,KAA7E,CAAmF,QAAnF,EAA6F,KAAKH,YAAL,GAAoB,IAAjH;AACA,gBAAIqI,IAAIrE,KAAKsE,GAAL,CAASzC,OAAO,KAAK/F,WAAZ,IAA2B,CAApC,EAAuC+F,OAAO,KAAK7F,YAAZ,IAA4B,CAAnE,IAAwE,IAAhF;AACA,iBAAKf,UAAL,CAAgBsJ,KAAhB,CAAsB,KAAKzI,WAA3B,EAAwC0I,MAAxC,CAA+C,KAAKxI,YAApD,EAAkEoG,WAAlE,CAA8EiC,CAA9E,EAAiFI,WAAjF,CAA6FJ,IAAI,GAAjG,EAAsGH,MAAtG;AACD;;;;;;AAKHpM,mBAAa4M,WAAb,GAA2B,yEAA3B;;8BAEE5M,Y","file":"analysis.js","sourcesContent":["import _ from 'lodash';\nimport angular from 'angular';\nimport * as d3 from '../../external/d3.min.js';\nimport vizuly from '../../external/vizuly_core.min.js';\nimport '../../external/vizuly_corona.min.js';\nimport Dygraph from '../../external/dygraph.min.js';\nimport * as Downsampler from './downsample.js';\nimport * as Colormap from './colormaps.js';\nimport * as Testdata from './testdata.js';\n\n//public/plugins/flexscada-app/img/\nclass AnalysisCtrl {\n  /** @ngInject */\n  constructor($scope, $injector, $rootScope, $location, $modal, $anchorScroll, $timeout, $window, $q, backendSrv, alertSrv) {\n    var self = this;\n    this.backendSrv = backendSrv;\n    this.$location = $location;\n    this.$timeout = $timeout;\n    this.$q = $q;\n    this.alertSrv = alertSrv;\n    this.$window = $window;\n    this.$rootScope = $rootScope;\n    $window.scope = $scope;\n    $window.rootscope = $rootScope;\n    this.pageReady = false;\n    this.ignoreChanges = false;\n    this.config = {};\n    this.deviceStatus = 0; // 0 unloaded, 1 loaded\n\n    if (\"device\" in $location.search()) {\n      console.log(location.search().device);\n      //  this.loadDevice($location.search().device);\n    }\n\n    self.pageReady = true;\n\n    $window.onbeforeunload = function() {\n      if (self.ignoreChanges) {\n        return;\n      }\n      if (self.changesPending()) {\n        return \"There are unsaved changes to this dashboard\";\n      }\n    };\n    $scope.$on('$locationChangeStart', function(event, next) {\n      if ((!self.ignoreChanges) && (self.changesPending())) {\n        event.preventDefault();\n        var baseLen = $location.absUrl().length - $location.url().length;\n        var nextUrl = next.substring(baseLen);\n        var modalScope = $scope.$new();\n        modalScope.ignore = function() {\n          self.ignoreChanges = true;\n          $location.url(nextUrl);\n          return;\n        };\n        modalScope.save = function() {\n          self.savePending(nextUrl);\n        };\n        $rootScope.appEvent('show-modal', {\n          src: 'public/app/partials/unsaved-changes.html',\n          modalClass: 'confirm-modal',\n          scope: modalScope,\n        });\n      }\n    });\n\n    this.radialLayouts = [{\n        text: \"Stacked\",\n        value: \"STACKED\"\n      },\n      {\n        text: \"Overlap\",\n        value: \"OVERLAP\"\n      }\n    ];\n\n\n    this.filterModes = [{\n        text: \"FIR Band Pass\",\n        value: \"fir_band_pass\"\n      },\n      {\n        text: \"FIR High Pass\",\n        value: \"fir_high_pass\"\n      },\n      {\n        text: \"FIR Low Pass\",\n        value: \"fir_low_pass\"\n      }\n    ];\n\n    this.filterTaps = [\"1024\", \"512\", \"256\", \"128\", \"64\", \"32\", \"16\", \"8\", \"4\"];\n    this.windowModes = [\"kaiser\", \"flattop\", \"lanczos\", \"bohman\", \"bartlett\", \"triangular\", \"gaussian\", \"blackman_harris\", \"blackman\", \"hamming\", \"hann\"];\n\n\n\n    //Fire Sunset Neon Ocean Business\n    this.radialThemes = [{\n        text: \"Sunset\",\n        value: \"Sunset\"\n      },\n      {\n        text: \"Fire\",\n        value: \"Fire\"\n      },\n      {\n        text: \"Neon\",\n        value: \"Neon\"\n      },\n      {\n        text: \"Ocean\",\n        value: \"Ocean\"\n      },\n      {\n        text: \"Light\",\n        value: \"Business\"\n      }\n    ];\n\n    // debugger;\n    this.radial_viz = vizuly.component.corona(window.document.getElementById('radial_viz_element'));\n\n    $('.vz-background').remove();\n\n    this.radial_data = []; // data object\n    this.radial_viz_element = ''; // html element that holds the viz (d3 selection)\n    this.radial_viz_title_element = ''; // title element (d3 selection)\n    this.radial_viz_heading_element = ''; // Title elements\n    this.radial_viz_theme = ''; // Theme variable to be used by our viz.\n\n    this.screenWidth = window.innerWidth * 0.75;\n    this.screenHeight = window.innerHeight;\n    // Set the size of our container element.\n\n    this.radial_viz_element = d3.selectAll(\"#radial_viz_element\")\n      .style(\"width\", this.screenWidth + \"px\")\n      .style(\"height\", this.screenHeight + \"px\");\n    this.loadData();\n\n\n\n\n    //FFT PLOT\n\n\n\n    // Shift one portion out of line.\n    var highlight_start = 450;\n    var highlight_end = 500;\n\n\n\n    // A basic sinusoidal data series.\n    var data = [];\n\n    this.fft = new Dygraph(window.document.getElementById(\"fft\"), data, {\n      labels: ['Frequency', 'G.'],\n      ylabel: 'Amplitude (G)',\n      xlabel: 'Frequency (HZ)',\n      axes: {\n        x: {\n          axisLabelFormatter: function(d, gran) {\n            return d + 'hz';\n          },\n          valueFormatter: function(ms) {\n            return ms + 'hz';\n          }\n        },\n        y: {\n          axisLabelFormatter: function(d, gran) {\n            return d + 'G';\n          },\n          valueFormatter: function(ms) {\n            return ms + 'G';\n          }\n        }\n      },\n      legend: 'follow',\n      //  dateWindow: [0, 9],\n      plotter: this.barChartPlotter,\n      colorValue: 0.9,\n      fillAlpha: 0.2,\n      showRoller: false,\n      showRangeSelector: false,\n      rangeSelectorPlotFillColor: 'MediumSlateBlue',\n      rangeSelectorPlotFillGradientColor: 'rgba(123, 104, 238, 0)',\n      animatedZooms: true,\n      underlayCallback: function(canvas, area, g) {\n        var bottom_left = g.toDomCoords(highlight_start, -20);\n        var top_right = g.toDomCoords(highlight_end, +20);\n        var left = bottom_left[0];\n        var right = top_right[0];\n        canvas.fillStyle = \"rgba(255, 255, 102, 1.0)\";\n        canvas.fillRect(left, area.y, right - left, area.h);\n      }\n    });\n\n\n\n\n\n\n    // BIN OVER TIME PLOT\n\n\n\n\n    this.rawplot = new Dygraph(window.document.getElementById(\"bin_amplitude\"), data, {\n      labels: ['Time', 'Value'],\n      ylabel: 'Amplitude (G)',\n      xlabel: 'Time (MS)',\n      axes: {\n        x: {\n          axisLabelFormatter: function(d, gran) {\n            return d + 'ms';\n          },\n          valueFormatter: function(ms) {\n            return ms + 'ms';\n          }\n        },\n        y: {\n          axisLabelFormatter: function(d, gran) {\n            return d + 'G';\n          },\n          valueFormatter: function(ms) {\n            return ms + 'G';\n          }\n        }\n      },\n      colorValue: 0.9,\n      fillAlpha: 0.4,\n      showRoller: false,\n      legend: 'follow',\n      showRangeSelector: false,\n      rangeSelectorPlotFillColor: 'MediumSlateBlue',\n      rangeSelectorPlotFillGradientColor: 'rgba(123, 104, 238, 0)',\n      animatedZooms: true\n    });\n\n\n    this.loadRaw(1, 131072);\n    this.loadFFT(1, 131072);\n  }\n\n\n\n\n\n\n\n\n  barChartPlotter(e) {\n    var ctx = e.drawingContext;\n    var points = e.points;\n    var y_bottom = e.dygraph.toDomYCoord(0); // see <a href=\"http://dygraphs.com/jsdoc/symbols/Dygraph.html#toDomYCoord\">jsdoc</a>\n    // This should really be based on the minimum gap\n\n    ctx.fillStyle = e.color; // a lighter shade might be more aesthetically pleasing\n\n\n\n\n\n    points = Downsampler.dygraph_downsample(points, 2048, 'max');\n\n    var bar_width = 2 / 3 * (points[1].canvasx - points[0].canvasx);\n\n\n    // Do the actual plotting.\n    for (var i = 0; i < points.length; i++) {\n      var p = points[i];\n      //Colormap.maps\n\n      var colorIndex = (e.plotArea.h - p.canvasy) / e.plotArea.h;\n      var color = Colormap.interpolateLinearly(colorIndex, Colormap.jet);\n      ctx.strokeStyle = \"rgb(\" +\n        Math.round(255 * color[0]) + \",\" +\n        Math.round(255 * color[1]) + \",\" +\n        Math.round(255 * color[2]) +\n        \")\";\n      ctx.fillStyle = ctx.strokeStyle;\n\n      ctx.fillRect(p.canvasx - bar_width / 2, p.canvasy, bar_width, y_bottom - p.canvasy);\n      //  ctx.strokeRect(p.canvasx - bar_width / 2, p.canvasy, bar_width, y_bottom - p.canvasy);\n    }\n  }\n\n\n\n\n  addRange() {\n    if (!this.config.ranges) {\n      this.config.ranges = [];\n    }\n\n    this.config.ranges.push({\n      label: \"\"\n    }) - 1;\n  }\n\n  deleteRange(id) {\n    this.config.ranges.splice(id, 1);\n  }\n\n\n  loadRaw(id, points) {\n    var self = this;\n\n    var options = {\n      mode: \"raw\"\n    };\n\n    return this.backendSrv.post('api/plugin-proxy/flexscada-app/api/vibration/v1/fft/' + id, options)\n      .then((resp) => {\n        self.$window.console.log(resp);\n        if (resp.meta.code !== 200) {\n          self.alertSrv.set(\"failed to load fft.\", resp.meta.message, 'error', 10000);\n          return self.$q.reject(resp.meta.message);\n        }\n\n        var data = [];\n\n        for (var i = 0; i < resp.data.length; i++) {\n          data.push([i * resp.ms_per_point, resp.data[i]]);\n        }\n\n        self.rawplot.updateOptions({\n          'file': data\n        });\n\n      });\n  }\n\n\n\n  loadFFT(id, points) {\n    var self = this;\n\n    var options = {\n      mode: \"fft\"\n    };\n\n    return this.backendSrv.post('api/plugin-proxy/flexscada-app/api/vibration/v1/fft/' + id, options)\n      .then((resp) => {\n        self.$window.console.log(resp);\n        if (resp.meta.code !== 200) {\n          self.alertSrv.set(\"failed to load fft.\", resp.meta.message, 'error', 10000);\n          return self.$q.reject(resp.meta.message);\n        }\n\n        var fftData = [];\n\n        for (var i = 0; i < resp.data.length; i++) {\n          fftData.push([i * resp.hzperbin, resp.data[i]]);\n        }\n\n        self.fft.updateOptions({\n          'file': fftData\n        });\n\n      });\n  }\n\n\n\n  loadDevice(uid) {\n    var self = this;\n    return this.backendSrv.get('api/plugin-proxy/flexscada-app/api/vibration/v1/config/' + uid).then((resp) => {\n      self.$window.console.log(resp);\n      if (resp.meta.code !== 200) {\n        self.alertSrv.set(\"failed to update device.\", resp.meta.message, 'error', 10000);\n        return self.$q.reject(resp.meta.message);\n      }\n      self.config = resp.body;\n      this.deviceStatus = 2;\n    });\n  }\n\n\n\n  changesPending() {\n    var changes = false;\n    return changes;\n  }\n\n\n\n  loadData() {\n    // Load our data via d3\n    var allSeries = [];\n    for (var hz = 1; hz < 5; hz++) {\n      var series = [];\n      var key = hz + 'hz';\n      for (var ms = 0; ms < 360; ms++) {\n        series.push({\n          \"key\": key,\n          \"frequency\": key,\n          \"amplitude\": Number((Math.sin((ms / 5) + hz / 5) + 2)) / hz,\n          \"position\": String(ms)\n        });\n      }\n      allSeries.push(series);\n    }\n    this.radial_data = allSeries;\n    console.log(this.radial_data);\n    // Call our initialize routine\n    this.initialize();\n  }\n\n\n\n\n\n\n\n  initialize() {\n    var self = this;\n    //to the corresponding x and y axis within the chart.\n    this.radial_viz.data(this.radial_data).margin({\n        top: \"15%\",\n        left: \"0%\",\n        right: \"0%\",\n        bottom: \"10%\"\n      }).outerRadius(350).y(function(d, i) {\n        return d.amplitude; //Value to use for the radius (y)\n      }).x(function(d, i) {\n        return d.position; //Value to use fo the angle (x)\n      }).interpolate(\"cardinal-closed\") //Vertex type for line and area paths\n      .on(\"validate\", function() { // onValidate\n        // Set appropriate axis labels after viz validates and automatically creates any public properties.\n        self.radial_viz.xAxis().tickFormat(function(d) {\n          return d + 'Â°';\n        });\n        self.radial_viz.yAxis().tickFormat(function(d) {\n          return Math.round(d * 100) / 100 + \" G\";\n        });\n        self.radial_viz.xAxis().ticks(8);\n        self.radial_viz.yAxis().ticks(6);\n      }) //Called when all public properties have been set\n      .on(\"mouseover\", function(d, i) { //onMouseOver\n        // Show UI elements to user based on our specific data.\n        var fontSize = Math.round(self.radial_viz.outerRadius() / 20);\n        // Get the SVG defs tag\n        var defs = self.radial_viz.selection().selectAll(\"defs\");\n\n\n        // Get the svg plot\n        var plot = self.radial_viz.selection().selectAll(\".vz-plot\");\n\n\n\n        // Remove any elements left from last datatip in case mouseout didn't get them.\n        defs.selectAll(\".vz-tip-path\").remove();\n        plot.selectAll(\".my-tip\").remove();\n\n\n        // Add the arc we need to show the frequency amplitude\n        defs.append(\"path\").attr(\"class\", \"vz-tip-path\").attr(\"id\", function(d, i) {\n          return self.radial_viz.id() + \"_tip_path_arc_1\";\n        }).attr(\"d\", function() {\n          return vizuly.svg.text.arcPath(self.radial_viz.radiusScale()(d.y + d.y0) * 1.05, self.radial_viz.thetaScale()(self.radial_viz.x()(d)));\n        });\n\n\n        // Show the position\n        plot.append(\"text\").attr(\"class\", \"my-tip\").style(\"font-size\", (fontSize * 0.95) + \"px\").style(\"text-transform\", \"uppercase\").style(\"font-family\", \"Open Sans\").style(\"fill-opacity\", 0.75).style(\"fill\", function() {\n          return self.radial_viz_theme.skin().labelColor;\n        }).append(\"textPath\").attr(\"startOffset\", \"50%\").style(\"overflow\", \"visible\").attr(\"xlink:href\", function(d, i) {\n          return \"#\" + self.radial_viz.id() + \"_tip_path_arc_1\";\n        }).text(function() {\n          return self.radial_viz.xAxis().tickFormat()(self.radial_viz.x()(d));\n        });\n\n\n        // Show the frequency amplitude\n        plot.append(\"text\").attr(\"class\", \"my-tip\").attr(\"y\", -fontSize * 1.5).style(\"font-size\", fontSize + \"px\").style(\"fill\", function() {\n          return self.radial_viz_theme.skin().labelColor;\n        }).text(function() {\n          return self.radial_viz.yAxis().tickFormat()(self.radial_viz.y()(d));\n        });\n        //Show the frequency\n        plot.append(\"text\").attr(\"class\", \"my-tip\").style(\"font-size\", fontSize + \"px\").style(\"fill-opacity\", 0.75).style(\"fill\", function() {\n          return self.radial_viz_theme.skin().labelColor;\n        }).text(function() {\n          return d.key;\n        });\n\n\n      }) //Called on each datatip mouseover\n\n\n\n      .on(\"mouseout\", function(d, i) { //onMouseOut\n        // Remove any elements we have created on mouse over\n        self.radial_viz.selection().selectAll(\".vz-tip-path\").remove();\n        self.radial_viz.selection().selectAll(\".my-tip\").remove();\n      }) //Called on each datatip mouseout\n      .on(\"measure\", function() {\n        //Each time viz measures itself we want to reset some UI elements;\n\n        /*\n\n      self.radial_viz_title_element.attr(\"x\",self.radial_viz.width() / 2).style(\"font-size\", function () {\n      return self.radial_viz.height() / 60\n    }).style(\"fill\", function () {\n    return self.radial_viz_theme.skin().labelColor;\n  });\n\n\n  self.radial_viz_heading_element.attr(\"x\", self.radial_viz.width() / 2)\n  .style(\"font-size\", function () {\n  return self.radial_viz.height() / 65;\n})\n.style(\"fill\", function () {\nreturn self.radial_viz_theme.skin().labelColor;\n})\n.style(\"fill-opacity\", .7);\n*/\n      }); //Called each time viz measures itself prior to update\n\n\n    this.radial_viz_theme = vizuly.theme.radial_linearea(this.radial_viz).skin(vizuly.skin.LINEAREA_FIRE);\n\n    /*\n    this.radial_viz_title_element = this.radial_viz.selection().select(\"svg\").append(\"text\").attr(\"class\", \"title\")\n    .attr(\"y\", 35).attr(\"text-anchor\", \"middle\")\n    .text(\"WWW.BRIGHTPOINTINC.COM - PAGE VIEWS BY HOUR\");\n    this.radial_viz_heading_element = this.radial_viz.selection().select(\"svg\").append(\"text\").attr(\"class\", \"heading\")\n    .attr(\"y\", 55).attr(\"text-anchor\", \"middle\")\n    .text(\"Google Analytics - Dec 01, 2015\");\n    */\n\n    this.updateRadialSize();\n  }\n\n\n\n\n\n\n\n  updateRadialTheme() {\n    // Fire Sunset Neon Ocean Business\n    if (!this.config.radialTheme) {\n      return;\n    }\n\n    this.radial_viz_theme.skin(this.config.radialTheme);\n    //   this.radial_viz_title_element.style(\"fill\", this.radial_viz_theme.skin().labelColor)\n    //   this.radial_viz_heading_element.style(\"fill\", this.radial_viz_theme.skin().labelColor)\n    this.radial_viz_theme.apply();\n  }\n\n\n\n  updateRadialLayout() {\n    // STACKED OVERLAP\n    this.radial_viz.layout(this.config.radialLayout).update();\n  }\n\n\n\n  changeShape(val) {\n    console.log(val);\n    this.radial_viz.interpolate(val).update();\n  }\n\n\n\n  updateRadialSize() {\n    this.radial_viz_element.transition().style('width', this.screenWidth + 'px').style('height', this.screenHeight + 'px');\n    var r = Math.min(Number(this.screenWidth) / 2, Number(this.screenHeight) / 2) * 0.75;\n    this.radial_viz.width(this.screenWidth).height(this.screenHeight).outerRadius(r).innerRadius(r * 0.4).update();\n  }\n\n\n\n}\nAnalysisCtrl.templateUrl = 'public/plugins/flexscada-app/components/analysis/partials/analysis.html';\nexport {\n  AnalysisCtrl\n};\n"]}